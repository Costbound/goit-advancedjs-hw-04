{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst pixabayApiUrl = 'https://pixabay.com/api/';\nconst PER_PAGE = 15;\nconst MAX_PAGES = 500 / PER_PAGE;\n\nconst defaultConfig = {\n  key: '40945002-e125ab8d3394997b1a8dc0871',\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: true,\n  per_page: PER_PAGE,\n};\n\nexport default async function fetchImages(searchWord, pixabayConfig = {}) {\n  if (pixabayConfig.page > MAX_PAGES) return { hits: [] };\n  const res = await axios.get(pixabayApiUrl, {\n    params: { ...defaultConfig, ...pixabayConfig, q: searchWord },\n  });\n  console.log(res.data.hits);\n  return res.data;\n}\n","import iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\n\nexport const gallery = document.querySelector('.gallery');\nexport const moreBtn = document.querySelector('.more-btn');\nconst moreContainer = document.querySelector('.more_container');\n\nconst loader = document.createElement('span');\nloader.classList.add('loader');\n\niziToast.settings({\n  position: 'topRight',\n  messageSize: '16px',\n  displayMode: 2,\n});\n\nconst simpleGallery = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nexport function buildImagesHtml(images) {\n  return images\n    .map(\n      ({\n        largeImageURL,\n        webformatURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `<li class=\"gallery-item\">\n            <div class=\"img-wrapper\">\n              <a href=\"${largeImageURL}\">\n                  <img\n                    class=\"gallery-img\"\n                    src=\"${webformatURL}\" \n                    alt=\"${tags}\"\n                    width=\"360\"\n                    height=\"200\">\n              </a> \n            </div>\n            <div class=\"text-wrapper\">\n              <ul class=\"img-info-list\">\n                <li class=\"info-item\">\n                  <h3 class=\"info-title\">likes</h3>\n                  <p class=\"info-text\">${likes}</p>\n                </li>\n                <li class=\"info-item\">\n                  <h3 class=\"info-title\">views</h3>\n                  <p class=\"info-text\">${views}</p>\n                </li>\n                <li class=\"info-item\">\n                  <h3 class=\"info-title\">comments</h3>\n                  <p class=\"info-text\">${comments}</p>\n                </li>\n                <li class=\"info-item\">\n                  <h3 class=\"info-title\">downloads</h3>\n                  <p class=\"info-text\">${downloads}</p>\n                </li>\n              </ul>\n            </div>\n        </li>`;\n      }\n    )\n    .join(' ');\n}\n\nconst clearGallery = () => {\n  gallery.innerHTML = '';\n};\n\nexport const renderNewGallery = (images, totalHits) => {\n  const imagesHtml = buildImagesHtml(images);\n  gallery.innerHTML = imagesHtml;\n  simpleGallery.refresh();\n  totalHits > 15 ? showMoreBtn() : hideMoreBtn();\n};\n\nexport const appendImagesHtmlToGallery = images => {\n  const imagesHtml = buildImagesHtml(images);\n  gallery.insertAdjacentHTML('beforeend', imagesHtml);\n  simpleGallery.refresh();\n};\n\nexport const renderLoaderInGallery = () => {\n  clearGallery();\n  gallery.append(loader);\n  loader.classList.add('center');\n};\n\nexport const renderLoaderInMoreContainer = () => {\n  hideMoreBtn();\n  moreContainer.append(loader);\n};\n\nexport const removeAndResetLoader = () => {\n  loader.remove();\n  loader.className = 'loader';\n};\n\nexport const showMoreBtn = () => {\n  moreBtn.classList.remove('visually-hidden');\n};\n\nexport const hideMoreBtn = () => {\n  moreBtn.classList.add('visually-hidden');\n};\n\nexport const showErrorMessage = message => {\n  iziToast.error({\n    message,\n  });\n};\n","import 'izitoast/dist/css/iziToast.min.css';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport fetchImages from './js/pixabay-api';\nimport {\n  hideMoreBtn,\n  moreBtn,\n  removeAndResetLoader,\n  renderNewGallery,\n  showErrorMessage,\n  renderLoaderInGallery,\n  renderLoaderInMoreContainer,\n  appendImagesHtmlToGallery,\n  showMoreBtn,\n  gallery,\n} from './js/render-functions';\n\nconst form = document.querySelector('form');\nconst [searchInput] = form.elements;\n\nlet searchWord = '';\nlet page = 1;\n\nform.addEventListener('submit', async e => {\n  e.preventDefault();\n  searchWord = page = 1;\n  renderLoaderInGallery();\n  try {\n    searchWord = parseSearchInput();\n    const { hits: images, totalHits } = await fetchImages(searchWord, { page });\n    if (images.length === 0) {\n      showErrorMessage(\n        'Sorry, there are no images matching your search query. Please try again!'\n      );\n      return;\n    }\n    renderNewGallery(images, totalHits);\n  } catch (error) {\n    handleError(error);\n  } finally {\n    removeAndResetLoader();\n  }\n});\n\nmoreBtn.addEventListener('click', async () => {\n  renderLoaderInMoreContainer();\n  try {\n    const { hits: images } = await fetchImages(searchWord, { page: page + 1 });\n    page++;\n    if (images.length === 0) {\n      showErrorMessage(\n        \"We're sorry, but you've reached the end of search results.\"\n      );\n      return;\n    }\n    appendImagesHtmlToGallery(images);\n    showMoreBtn();\n    scrollToNewImages();\n  } catch (error) {\n    handleError(error);\n  } finally {\n    removeAndResetLoader();\n  }\n});\n\nconst handleError = error => {\n  console.error('Error:', error);\n  if (error.message) {\n    showErrorMessage(error.message);\n    return;\n  }\n  showErrorMessage('Something went wrong. Please try again later.');\n};\n\nfunction scrollToNewImages() {\n  const card = gallery.querySelector('.gallery-item');\n  if (card) {\n    const cardHeight = card.getBoundingClientRect().height;\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n  }\n}\n\nconst parseSearchInput = () => {\n  const inputValue = searchInput.value.trim();\n  if (inputValue === '') {\n    hideMoreBtn();\n    throw new Error('Search field cannot be empty');\n  }\n  return inputValue;\n};\n"],"names":["pixabayApiUrl","PER_PAGE","MAX_PAGES","defaultConfig","fetchImages","searchWord","pixabayConfig","res","axios","gallery","moreBtn","moreContainer","loader","iziToast","simpleGallery","SimpleLightbox","buildImagesHtml","images","largeImageURL","webformatURL","tags","likes","views","comments","downloads","clearGallery","renderNewGallery","totalHits","imagesHtml","showMoreBtn","hideMoreBtn","appendImagesHtmlToGallery","renderLoaderInGallery","renderLoaderInMoreContainer","removeAndResetLoader","showErrorMessage","message","form","searchInput","page","parseSearchInput","error","handleError","scrollToNewImages","card","cardHeight","inputValue"],"mappings":"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"}